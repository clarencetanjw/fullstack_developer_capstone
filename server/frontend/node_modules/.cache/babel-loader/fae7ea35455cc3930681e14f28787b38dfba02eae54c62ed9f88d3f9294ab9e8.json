{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams}from'react-router-dom';import\"./Dealers.css\";import\"../assets/style.css\";import Header from'../Header/Header';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const PostReview=()=>{const[dealer,setDealer]=useState({});const[review,setReview]=useState(\"\");const[model,setModel]=useState();const[year,setYear]=useState(\"\");const[date,setDate]=useState(\"\");const[carmodels,setCarmodels]=useState([]);let curr_url=window.location.href;let root_url=curr_url.substring(0,curr_url.indexOf(\"postreview\"));let params=useParams();let id=params.id;let dealer_url=root_url+\"djangoapp/dealer/\".concat(id);let review_url=root_url+\"djangoapp/add_review\";let carmodels_url=root_url+\"djangoapp/get_cars\";const postreview=async()=>{let name=sessionStorage.getItem(\"firstname\")+\" \"+sessionStorage.getItem(\"lastname\");//If the first and second name are stores as null, use the username\nif(name.includes(\"null\")){name=sessionStorage.getItem(\"username\");}if(!model||review===\"\"||date===\"\"||year===\"\"||model===\"\"){alert(\"All details are mandatory\");return;}let model_split=model.split(\" \");let make_chosen=model_split[0];let model_chosen=model_split[1];let jsoninput=JSON.stringify({\"name\":name,\"dealership\":id,\"review\":review,\"purchase\":true,\"purchase_date\":date,\"car_make\":make_chosen,\"car_model\":model_chosen,\"car_year\":year});console.log(jsoninput);const res=await fetch(review_url,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:jsoninput});const json=await res.json();if(json.status===200){window.location.href=window.location.origin+\"/dealer/\"+id;}};const get_dealer=async()=>{const res=await fetch(dealer_url,{method:\"GET\"});const retobj=await res.json();if(retobj.status===200){let dealerobjs=Array.from(retobj.dealer);if(dealerobjs.length>0)setDealer(dealerobjs[0]);}};const get_cars=async()=>{const res=await fetch(carmodels_url,{method:\"GET\"});const retobj=await res.json();let carmodelsarr=Array.from(retobj.CarModels);setCarmodels(carmodelsarr);};useEffect(()=>{get_dealer();get_cars();},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(\"div\",{style:{margin:\"5%\"},children:[/*#__PURE__*/_jsx(\"h1\",{style:{color:\"darkblue\"},children:dealer.full_name}),/*#__PURE__*/_jsx(\"textarea\",{id:\"review\",cols:\"50\",rows:\"7\",onChange:e=>setReview(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"input_field\",children:[\"Purchase Date \",/*#__PURE__*/_jsx(\"input\",{type:\"date\",onChange:e=>setDate(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input_field\",children:[\"Car Make\",/*#__PURE__*/_jsxs(\"select\",{name:\"cars\",id:\"cars\",onChange:e=>setModel(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",selected:true,disabled:true,hidden:true,children:\"Choose Car Make and Model\"}),carmodels.map(carmodel=>/*#__PURE__*/_jsxs(\"option\",{value:carmodel.CarMake+\" \"+carmodel.CarModel,children:[carmodel.CarMake,\" \",carmodel.CarModel]}))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input_field\",children:[\"Car Year \",/*#__PURE__*/_jsx(\"input\",{type:\"int\",onChange:e=>setYear(e.target.value),max:2023,min:2015})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"postreview\",onClick:postreview,children:\"Post Review\"})})]})]});};export default PostReview;","map":{"version":3,"names":["React","useState","useEffect","useParams","Header","jsx","_jsx","jsxs","_jsxs","PostReview","dealer","setDealer","review","setReview","model","setModel","year","setYear","date","setDate","carmodels","setCarmodels","curr_url","window","location","href","root_url","substring","indexOf","params","id","dealer_url","concat","review_url","carmodels_url","postreview","name","sessionStorage","getItem","includes","alert","model_split","split","make_chosen","model_chosen","jsoninput","JSON","stringify","console","log","res","fetch","method","headers","body","json","status","origin","get_dealer","retobj","dealerobjs","Array","from","length","get_cars","carmodelsarr","CarModels","children","style","margin","color","full_name","cols","rows","onChange","e","target","value","className","type","selected","disabled","hidden","map","carmodel","CarMake","CarModel","max","min","onClick"],"sources":["/home/project/fullstack_developer_capstone/server/frontend/src/components/Dealers/PostReview.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport \"./Dealers.css\";\nimport \"../assets/style.css\";\nimport Header from '../Header/Header';\n\n\nconst PostReview = () => {\n  const [dealer, setDealer] = useState({});\n  const [review, setReview] = useState(\"\");\n  const [model, setModel] = useState();\n  const [year, setYear] = useState(\"\");\n  const [date, setDate] = useState(\"\");\n  const [carmodels, setCarmodels] = useState([]);\n\n  let curr_url = window.location.href;\n  let root_url = curr_url.substring(0,curr_url.indexOf(\"postreview\"));\n  let params = useParams();\n  let id =params.id;\n  let dealer_url = root_url+`djangoapp/dealer/${id}`;\n  let review_url = root_url+`djangoapp/add_review`;\n  let carmodels_url = root_url+`djangoapp/get_cars`;\n\n  const postreview = async ()=>{\n    let name = sessionStorage.getItem(\"firstname\")+\" \"+sessionStorage.getItem(\"lastname\");\n    //If the first and second name are stores as null, use the username\n    if(name.includes(\"null\")) {\n      name = sessionStorage.getItem(\"username\");\n    }\n    if(!model || review === \"\" || date === \"\" || year === \"\" || model === \"\") {\n      alert(\"All details are mandatory\")\n      return;\n    }\n\n    let model_split = model.split(\" \");\n    let make_chosen = model_split[0];\n    let model_chosen = model_split[1];\n\n    let jsoninput = JSON.stringify({\n      \"name\": name,\n      \"dealership\": id,\n      \"review\": review,\n      \"purchase\": true,\n      \"purchase_date\": date,\n      \"car_make\": make_chosen,\n      \"car_model\": model_chosen,\n      \"car_year\": year,\n    });\n\n    console.log(jsoninput);\n    const res = await fetch(review_url, {\n      method: \"POST\",\n      headers: {\n          \"Content-Type\": \"application/json\",\n      },\n      body: jsoninput,\n  });\n\n  const json = await res.json();\n  if (json.status === 200) {\n      window.location.href = window.location.origin+\"/dealer/\"+id;\n  }\n\n  }\n  const get_dealer = async ()=>{\n    const res = await fetch(dealer_url, {\n      method: \"GET\"\n    });\n    const retobj = await res.json();\n    \n    if(retobj.status === 200) {\n      let dealerobjs = Array.from(retobj.dealer)\n      if(dealerobjs.length > 0)\n        setDealer(dealerobjs[0])\n    }\n  }\n\n  const get_cars = async ()=>{\n    const res = await fetch(carmodels_url, {\n      method: \"GET\"\n    });\n    const retobj = await res.json();\n    \n    let carmodelsarr = Array.from(retobj.CarModels)\n    setCarmodels(carmodelsarr)\n  }\n  useEffect(() => {\n    get_dealer();\n    get_cars();\n  },[]);\n\n\n  return (\n    <div>\n      <Header/>\n      <div  style={{margin:\"5%\"}}>\n      <h1 style={{color:\"darkblue\"}}>{dealer.full_name}</h1>\n      <textarea id='review' cols='50' rows='7' onChange={(e) => setReview(e.target.value)}></textarea>\n      <div className='input_field'>\n      Purchase Date <input type=\"date\" onChange={(e) => setDate(e.target.value)}/>\n      </div>\n      <div className='input_field'>\n      Car Make \n      <select name=\"cars\" id=\"cars\" onChange={(e) => setModel(e.target.value)}>\n      <option value=\"\" selected disabled hidden>Choose Car Make and Model</option>\n      {carmodels.map(carmodel => (\n          <option value={carmodel.CarMake+\" \"+carmodel.CarModel}>{carmodel.CarMake} {carmodel.CarModel}</option>\n      ))}\n      </select>        \n      </div >\n\n      <div className='input_field'>\n      Car Year <input type=\"int\" onChange={(e) => setYear(e.target.value)} max={2023} min={2015}/>\n      </div>\n\n      <div>\n      <button className='postreview' onClick={postreview}>Post Review</button>\n      </div>\n    </div>\n    </div>\n  )\n}\nexport default PostReview\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}